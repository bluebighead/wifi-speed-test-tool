# 用户使用教程

## 📋 教程概述

本教程将指导您从安装到使用WiFi Speed Test Tool的完整流程，帮助您快速掌握所有功能。

## 📖 目录

1. [快速开始](#快速开始)
2. [安装指南](#安装指南)
3. [界面介绍](#界面介绍)
4. [信道分析](#信道分析)
5. [信道推荐](#信道推荐)
6. [配置管理](#配置管理)
7. [高级功能](#高级功能)
8. [故障排除](#故障排除)
9. [最佳实践](#最佳实践)

## 🚀 快速开始

### 5分钟快速上手

1. **下载程序**
   - 从GitHub下载最新版本
   - 或克隆源代码: `git clone https://github.com/bluebighead/wifi-speed-test-tool.git`

2. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

3. **运行程序**
   ```bash
   python main.py
   ```

4. **开始使用**
   - 点击"信道分析"标签页
   - 点击"扫描信道"按钮
   - 查看信道占用情况
   - 切换到"信道推荐"标签页
   - 点击"分析并推荐"获取最优信道

## 📦 安装指南

### 系统要求

- **操作系统**: Windows 10/11
- **Python版本**: 3.8或更高
- **内存**: 最低2GB RAM
- **磁盘空间**: 最低500MB可用空间
- **权限**: 管理员权限（WiFi扫描功能）

### 详细安装步骤

#### 步骤1: 安装Python

1. 访问 [Python官网](https://www.python.org/downloads/)
2. 下载Python 3.8或更高版本
3. 运行安装程序
4. **重要**: 勾选"Add Python to PATH"
5. 完成安装

验证安装:
```bash
python --version
# 应该显示: Python 3.8.x 或更高
```

#### 步骤2: 下载项目

**方式1: 使用Git克隆**
```bash
git clone https://github.com/bluebighead/wifi-speed-test-tool.git
cd wifiTest
```

**方式2: 直接下载**
1. 访问 [项目主页](https://github.com/bluebighead/wifi-speed-test-tool)
2. 点击"Code"按钮
3. 选择"Download ZIP"
4. 解压到任意目录

#### 步骤3: 创建虚拟环境（推荐）

```bash
# 创建虚拟环境
python -m venv venv

# 激活虚拟环境
# Windows:
venv\Scripts\activate
# Linux/Mac:
source venv/bin/activate
```

#### 步骤4: 安装依赖

```bash
pip install -r requirements.txt
```

依赖包说明:
- `PyQt5`: GUI框架
- `pywifi`: WiFi操作库
- `matplotlib`: 图表绘制
- `requests`: 网络请求
- `numpy`: 数据处理

#### 步骤5: 运行程序

**方式1: 使用Python命令**
```bash
python main.py
```

**方式2: 使用批处理文件（Windows）**
```bash
run.bat
```

**方式3: 以管理员身份运行**

右键点击`run.bat`，选择"以管理员身份运行"

## 🖥️ 界面介绍

### 主窗口布局

```
┌─────────────────────────────────────────────────────┐
│ 菜单栏: 文件(F) | 视图(V) | 帮助(H)              │
├─────────────────────────────────────────────────────┤
│                                                     │
│  ┌─────────────────────────────────────────────┐    │
│  │ [信道分析] [信道推荐]                     │    │
│  └─────────────────────────────────────────────┘    │
│                                                     │
│  ┌─────────────────────────────────────────────┐    │
│  │                                             │    │
│  │          功能面板内容区域                    │    │
│  │                                             │    │
│  └─────────────────────────────────────────────┘    │
│                                                     │
├─────────────────────────────────────────────────────┤
│ 状态栏: 准备就绪                                  │
└─────────────────────────────────────────────────────┘
```

### 菜单栏

**文件(F)**
- 退出(X) - 退出程序 (快捷键: Ctrl+Q)

**视图(V)**
- 刷新(R) - 刷新当前标签页数据 (快捷键: F5)

**帮助(H)**
- 关于 - 显示程序信息

### 标签页

**信道分析**
- 信道扫描功能
- 信道占用图表
- 信道详情表格

**信道推荐**
- 信道质量测试
- 智能推荐算法
- 推荐结果展示

### 状态栏

显示当前程序状态和操作提示

## 📊 信道分析

### 基本操作

#### 1. 选择频段

在信道分析面板中，您可以选择要分析的频段:

- **2.4GHz**: 信道1-13，穿透力强，覆盖范围广
- **5GHz**: 信道36-165，速度快，干扰少

#### 2. 扫描信道

点击"扫描信道"按钮开始扫描:

```
┌─────────────────────────────────────┐
│  [2.4GHz ▼]  [扫描信道]         │
└─────────────────────────────────────┘
```

扫描过程:
1. 程序使用WiFi适配器扫描周围网络
2. 收集各信道的信号强度和占用情况
3. 计算信道质量评分
4. 更新图表和表格显示

#### 3. 查看结果

**信道占用图表**

图表显示:
- X轴: 信道编号
- Y轴: 信号强度 (dBm)
- 柱状图高度: 信号强度
- 柱状图颜色: 
  - 绿色: 优质信道 (评分≥80)
  - 黄色: 一般信道 (评分60-79)
  - 红色: 较差信道 (评分<60)

**信道详情表格**

表格显示:
- 信道编号
- 频率 (GHz)
- 频段
- 信号强度 (dBm)
- 占用率 (%)
- 干扰程度 (%)
- 质量评分 (0-100)
- 网络列表

#### 4. 自动刷新

勾选"自动刷新"复选框:

```
☑ 自动刷新 (每5秒)
```

启用后:
- 程序每5秒自动扫描一次
- 实时更新信道占用情况
- 适合监测信道变化

### 高级操作

#### 导出数据

1. 在信道详情表格中右键点击
2. 选择"导出数据"
3. 选择保存位置和格式
4. 点击"保存"

#### 查看历史记录

程序自动保存最近10次扫描记录:
1. 点击"历史记录"按钮
2. 选择要查看的记录
3. 点击"加载"

## 🎯 信道推荐

### 基本操作

#### 1. 准备工作

在使用信道推荐功能前，需要先扫描信道:

1. 切换到"信道分析"标签页
2. 选择频段 (2.4GHz或5GHz)
3. 点击"扫描信道"按钮
4. 等待扫描完成

#### 2. 设置测试次数

在控制面板中设置测试次数:

```
┌─────────────────────────────────────┐
│  测试次数: [50] (1-1000)        │
└─────────────────────────────────────┘
```

设置步骤:
1. 点击显示测试次数的按钮
2. 在弹出的对话框中输入新的测试次数 (1-1000)
3. 点击"确定"保存

**测试次数建议**:
- **快速测试**: 10-20次 (约10-20秒)
- **标准测试**: 50次 (约30-60秒)
- **精确测试**: 100-200次 (约1-3分钟)
- **专业测试**: 500-1000次 (约5-15分钟)

#### 3. 执行分析

点击"分析并推荐"按钮:

```
┌─────────────────────────────────────┐
│  [分析并推荐]  [应用推荐]        │
└─────────────────────────────────────┘
```

分析过程:
1. 程序检查是否有信道数据
   - 如果没有，提示用户先扫描信道
   - 如果有，继续执行分析
2. 对每个信道执行指定次数的测试
3. 采集关键指标:
   - 信号强度 (RSSI)
   - 信噪比 (SNR)
   - 信道带宽
   - 传输速率
   - 丢包率
4. 计算算术平均值
5. 应用加权算法计算综合评分
6. 生成推荐结果

#### 4. 查看推荐结果

**推荐卡片**

显示最优信道信息:
- 信道编号
- 频段
- 质量评分
- 推荐理由
- 预期改善效果

**测试数据表格**

显示详细的测试数据:
- 测试序号
- RSSI (dBm)
- SNR (dB)
- 带宽 (MHz)
- 速率 (Mbps)
- 丢包率 (%)

**注意**: 最多显示50行数据，超过时会显示提示信息

**分析详情**

显示多维度分析结果:
- 信号质量分析
- 传输性能分析
- 稳定性分析
- 综合评估

#### 5. 切换频段

在控制面板中切换频段:

```
┌─────────────────────────────────────┐
│  [2.4GHz]  [5GHz]              │
└─────────────────────────────────────┘
```

切换后:
- 自动更新显示内容
- 重新分析当前频段的信道
- 显示该频段的推荐结果

### 高级操作

#### 应用推荐

**重要**: 本程序仅提供信道推荐，实际信道更改需要在路由器设置中进行

应用步骤:
1. 记录推荐的信道编号
2. 登录路由器管理页面
3. 找到无线设置
4. 修改信道为推荐信道
5. 保存设置并重启路由器

#### 保存推荐结果

1. 点击"保存结果"按钮
2. 选择保存位置
3. 输入文件名
4. 点击"保存"

#### 比较不同频段

1. 切换到2.4GHz频段
2. 执行分析并记录结果
3. 切换到5GHz频段
4. 执行分析并记录结果
5. 比较两个频段的推荐结果

## ⚙️ 配置管理

### 配置文件位置

配置文件位于: `config/config.json`

### 配置项说明

#### 应用配置

```json
{
  "app": {
    "name": "WiFi Speed Test",
    "version": "1.0.0"
  }
}
```

#### WiFi配置

```json
{
  "wifi": {
    "scan_interval": 5,
    "bands": ["2.4GHz", "5GHz"],
    "test_count": 50
  }
}
```

- `scan_interval`: 自动刷新间隔 (秒)
- `bands`: 支持的频段列表
- `test_count`: 每个信道的测试次数

#### UI配置

```json
{
  "ui": {
    "chart_update_interval": 2000,
    "theme": "default"
  }
}
```

- `chart_update_interval`: 图表更新间隔 (毫秒)
- `theme`: 主题名称

#### 日志配置

```json
{
  "logging": {
    "level": "INFO",
    "max_file_size": 10485760,
    "backup_count": 5
  }
}
```

- `level`: 日志级别 (DEBUG, INFO, WARNING, ERROR, CRITICAL)
- `max_file_size`: 日志文件最大大小 (字节)
- `backup_count`: 保留的日志文件数量

### 修改配置

#### 方式1: 通过程序界面

1. 在程序中修改相关设置 (如测试次数)
2. 程序自动保存配置

#### 方式2: 直接编辑配置文件

1. 打开 `config/config.json`
2. 修改配置值
3. 保存文件
4. 重启程序使配置生效

### 配置备份

建议定期备份配置文件:

```bash
# 备份配置
copy config\config.json config\config.json.backup

# 恢复配置
copy config\config.json.backup config\config.json
```

## 🔧 高级功能

### 命令行参数

```bash
python main.py [选项]

选项:
  --help          显示帮助信息
  --version       显示版本信息
  --config FILE   指定配置文件
  --log LEVEL     设置日志级别
```

### 日志查看

日志文件位置: `logs/wifi_test.log`

查看日志:
```bash
# Windows
type logs\wifi_test.log

# Linux/Mac
cat logs/wifi_test.log

# 实时查看
tail -f logs/wifi_test.log
```

### 调试模式

启用调试模式:

1. 编辑 `config/config.json`
2. 修改 `"level": "DEBUG"`
3. 重启程序

调试模式会记录更详细的日志信息。

### 性能优化

#### 减少测试时间

- 降低测试次数 (如从50降到20)
- 减少扫描的信道数量
- 关闭自动刷新

#### 提高精度

- 增加测试次数 (如从50升到100)
- 在网络稳定时测试
- 多次测试取平均值

## 🔍 故障排除

### 常见问题及解决方案

#### 问题1: 程序无法启动

**症状**: 双击程序无反应或报错

**解决方案**:
1. 检查Python是否正确安装: `python --version`
2. 检查依赖是否安装: `pip list`
3. 以管理员身份运行程序
4. 查看日志文件: `logs/wifi_test.log`

#### 问题2: WiFi扫描失败

**症状**: 点击"扫描信道"后无响应或报错

**解决方案**:
1. 确保以管理员身份运行程序
2. 检查WiFi适配器是否正常工作
3. 重启WiFi适配器
4. 重启计算机
5. 查看日志文件获取详细错误信息

#### 问题3: 测试结果不准确

**症状**: 推荐结果与实际情况不符

**解决方案**:
1. 增加测试次数
2. 在网络稳定时测试
3. 多次测试取平均值
4. 检查是否有其他设备干扰
5. 更换测试位置

#### 问题4: 界面显示异常

**症状**: 界面布局错乱或显示不全

**解决方案**:
1. 调整系统DPI设置
2. 尝试不同的系统缩放比例
3. 重启程序
4. 更新显卡驱动
5. 检查屏幕分辨率设置

#### 问题5: 配置无法保存

**症状**: 修改配置后重启程序恢复默认值

**解决方案**:
1. 检查 `config/config.json` 文件权限
2. 确保磁盘有写入权限
3. 检查磁盘空间是否充足
4. 手动编辑配置文件

#### 问题6: 测试时间过长

**症状**: 分析过程需要很长时间

**解决方案**:
1. 降低测试次数
2. 减少扫描的信道数量
3. 关闭其他占用网络的应用
4. 使用更快的网络连接

### 获取帮助

如果以上解决方案无法解决问题:

1. 查看日志文件: `logs/wifi_test.log`
2. 访问 [GitHub Issues](https://github.com/bluebighead/wifi-speed-test-tool/issues)
3. 提交问题报告，包含:
   - 问题描述
   - 复现步骤
   - 错误日志
   - 系统信息

## 💡 最佳实践

### 测试建议

#### 1. 测试时间选择

- **最佳时间**: 凌晨或工作日的非高峰时段
- **避免时间**: 晚间高峰期 (19:00-23:00)
- **测试时长**: 每次测试至少30秒

#### 2. 测试位置选择

- **最佳位置**: 路由器附近
- **避免位置**: 墙角、地下室、金属物体附近
- **测试距离**: 距离路由器1-3米

#### 3. 测试环境准备

- 关闭其他占用网络的应用
- 确保网络连接稳定
- 避免同时使用多个WiFi设备
- 保持测试环境安静

#### 4. 测试次数设置

根据需求选择:
- **日常使用**: 20-50次
- **重要决策**: 100-200次
- **专业分析**: 500-1000次

### 信道选择建议

#### 2.4GHz频段

**推荐信道**: 1, 6, 11
- 这些信道互不干扰
- 适合大多数环境

**避免信道**: 2-5, 7-10
- 容易与推荐信道产生干扰

#### 5GHz频段

**推荐信道**: 36, 40, 44, 48, 149, 153, 157, 161, 165
- 干扰较少
- 速度更快

**注意**: 不同国家支持的信道可能不同

### 维护建议

#### 定期更新

- 定期检查程序更新
- 更新依赖包: `pip install --upgrade -r requirements.txt`
- 保持系统更新

#### 数据备份

- 定期备份配置文件
- 保存重要的测试结果
- 清理旧的日志文件

#### 性能监控

- 定期检查磁盘空间
- 监控日志文件大小
- 清理临时文件

## 📚 进阶阅读

- [技术架构文档](TECHNICAL.md) - 了解系统架构和设计
- [API文档](API.md) - 查看详细的API接口
- [常见问题](FAQ.md) - 查看更多问题和解决方案

## 🎓 学习资源

### WiFi基础知识

- [WiFi频段介绍](https://en.wikipedia.org/wiki/List_of_WLAN_channels)
- [信道干扰原理](https://www.metageek.com/training/resources/wifi-channel-planning.html)
- [信号强度标准](https://en.wikipedia.org/wiki/Received_signal_strength_indication)

### 网络优化技巧

- [路由器设置指南](https://www.howtogeek.com/125472/how-to-choose-the-best-channel-for-your-wireless-network/)
- [WiFi优化技巧](https://www.pcmag.com/how-to/how-to-fix-your-wi-fi-network-problems)
- [网络故障排除](https://support.microsoft.com/en-us/help/10741/windows-10-fix-wi-fi-connection-issues)

---

**教程版本**：1.0.0  
**最后更新**：2026-02-08  
**维护者**：WiFi Test Team
